new version of the polished code.
